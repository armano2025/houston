<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>יוסטון – השארת פרטים</title>
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;600&display=swap" rel="stylesheet">
  <meta name="theme-color" content="#2563eb"/>

  <style>
    :root{ --bg:#f7f8fb; --card:#fff; --brd:#e6eaf3; --txt:#0f172a; --muted:#6b7280 }
    *{ box-sizing:border-box }
    body{
      margin:0; font-family:'Rubik',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:var(--bg); color:var(--txt);
    }
    .wrap{ max-width:660px; margin:32px auto; padding:0 16px }
    .card{
      background:var(--card); border:1px solid var(--brd); border-radius:16px;
      box-shadow:0 10px 30px rgba(15,23,42,.08); padding:22px;
    }
    h1{ font-size:22px; margin:0 0 12px }
    p.sub{ margin:0 0 18px; color:var(--muted) }

    form{ display:grid; gap:12px }
    label{ font-weight:600; font-size:14px }
    input, select, textarea, button{
      font-family:inherit; font-size:16px
    }
    input, select, textarea{
      width:100%; padding:12px 14px; border:1px solid var(--brd); border-radius:12px; background:#fff;
    }
    textarea{ min-height:96px; resize:vertical }
    .row{ display:grid; gap:12px; grid-template-columns:1fr }
    @media (min-width:560px){ .row{ grid-template-columns:1fr 1fr } }

    .hp{ position:absolute !important; left:-9999px !important; opacity:0 !important; width:1px; height:1px }

    .actions{ display:flex; gap:10px; align-items:center; margin-top:4px }
    button{
      border:0; padding:12px 18px; border-radius:12px; cursor:pointer;
      background:#2563eb; color:#fff; font-weight:600;
      box-shadow:0 8px 16px rgba(37,99,235,.2);
    }
    button[disabled]{ opacity:.6; cursor:not-allowed; box-shadow:none }
    #msg{ font-size:14px; color:var(--muted) }
    .ok{ color:#0f766e } .err{ color:#b91c1c }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>השארת פרטים</h1>
      <p class="sub">ממלאים דקה, ואנחנו חוזרים אליך בהקדם.</p>

      <form id="leadForm" novalidate>
        <div class="row">
          <div>
            <label for="firstName">שם פרטי *</label>
            <input id="firstName" name="firstName" placeholder="לדוגמה: נועה" required />
          </div>
          <div>
            <label for="lastName">שם משפחה</label>
            <input id="lastName" name="lastName" placeholder="אופציונלי" />
          </div>
        </div>

        <div class="row">
          <div>
            <label for="phone">טלפון *</label>
            <input id="phone" name="phone" type="tel" inputmode="tel"
                   placeholder="05XXXXXXXX"
                   pattern="^0\d{8,9}$"
                   title="מספר ישראלי: מתחיל ב־0 ואורך 9–10 ספרות"
                   required />
          </div>
          <div>
            <label for="subject">מקצוע *</label>
            <select id="subject" name="subject" required>
              <option value="" disabled selected>בחר מקצוע</option>
              <option>מתמטיקה</option>
              <option>אנגלית</option>
              <option>פיזיקה</option>
              <option>שפה</option>
            </select>
          </div>
        </div>

        <div>
          <label for="notes">מה חשוב שנדע?</label>
          <textarea id="notes" name="notes" placeholder="למשל: ימים מועדפים, כיתה, רמת קושי"></textarea>
        </div>

        <!-- Honeypot: לא להסיר/לשנות את השם -->
        <input class="hp" name="website" tabindex="-1" autocomplete="off" />

        <div class="actions">
          <button id="submitBtn" type="submit">שלח</button>
          <div id="msg"></div>
        </div>
      </form>
    </div>
  </div>

  <script>
  // כתובת ה-Web App שלך ב-Apps Script
  const ENDPOINT = 'https://script.google.com/macros/s/AKfycbxRiJ_uMNpIJru-nNClAi787sA07hQSu7TX4cQEAm3_w3-dO2Hmp39ISxh81SqudA/exec';
  const ORIGIN   = location.origin;

  const form = document.getElementById('leadForm');
  const btn  = document.getElementById('submitBtn');
  const msg  = document.getElementById('msg');

  form.addEventListener('submit', async (ev) => {
    ev.preventDefault();

    // ולידציה בסיסית בצד לקוח
    if (!form.reportValidity()) return;

    btn.disabled = true;
    const prev = btn.textContent;
    btn.textContent = 'שולח...';
    msg.className = ''; msg.textContent = '';

    const data = Object.fromEntries(new FormData(form).entries());
    const url  = ENDPOINT + '?origin=' + encodeURIComponent(ORIGIN);

    try {
      const res  = await fetch(url, {
        method: 'POST',
        headers: { 'Content-Type':'application/json' },
        body: JSON.stringify(data)
      });

      const text = await res.text();
      let j = {};
      try { j = JSON.parse(text); } catch(_) {}

      if (j.ok) {
        msg.className = 'ok';
        msg.textContent = 'נקלט בהצלחה. מספר תיק: ' + j.caseId;
        form.reset();
      } else {
        const err = j.error || (res.ok ? 'unknown' : ('HTTP ' + res.status));
        msg.className = 'err';
        msg.textContent = 'שגיאה: ' + err;
      }
    } catch (e) {
      msg.className = 'err';
      msg.textContent = 'שגיאת רשת. נסה שוב.';
    } finally {
      btn.disabled = false;
      btn.textContent = prev;
    }
  });
  </script>
</body>
</html>